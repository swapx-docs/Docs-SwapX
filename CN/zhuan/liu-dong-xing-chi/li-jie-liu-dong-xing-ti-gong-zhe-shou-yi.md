# 🍇理解流动性提供者收益

#### 💰 理解流动性提供者收益

SwapX 激励用户为其交易池添加流动性，方式是奖励提供者其他用户在这些池中交易时产生的费用。然而，做市通常是一项复杂的活动，伴随着特定的风险。

**无常损失风险 ⚠️**

与简单持有资产（HODL）相比，在基础资产价格出现**显著且持续波动**期间，存在损失风险（称为**无常损失**）。

***

#### 💧 流动性代币机制

当用户提供流动性时，协议会向他们发放不可交易的\*\*“流动性代币”\*\*，以追踪其在池中的所有权份额。

* **示例情景：**
  * 某 LP 添加了 **10,000 DAI** 和 **100 WETH**（总价值：$20,000）。
  * 池中总共包含 **100,000 DAI** 和 **1,000 ETH**。
  * 该 LP 的份额为 $\frac{10,000}{100,000} = \mathbf{10%\}$ 的总流动性。
  * 合约铸造流动性代币，使其有权获得池中资产的 **10%**。
* **会计工具：** 流动性代币仅仅是一种会计或簿记工具，用于跟踪流动性提供者有权获得的份额。如果其他人随后添加/提取代币，将铸造/销毁新的流动性代币，以维持每个人在流动性池中的相对百分比份额。

***

#### 📉 价格变动影响（无常损失示例）

让我们使用恒定乘积公式 $x \* y = k$ 来检验价格变化的影响。

**情景：价格从 $100 上涨到 $150**

| 指标             | 初始状态（价格：$100）                          | 套利后（新价格：$150）        | LP 提取（10% 份额）                                   |
| -------------- | -------------------------------------- | -------------------- | ----------------------------------------------- |
| 池中资产（DAI, ETH） | 100,000 DAI, 1,000 ETH                 | 122,400 DAI, 817 ETH | 12,240 DAI, 81.7 ETH                            |
| LP 初始 HODL 价值  | $10,000 + (100 \times $150) = $25,000$ | N/A                  | N/A                                             |
| LP 提取价值        | N/A                                    | N/A                  | $(12,240) + (81.7 \times $150) \approx $24,500$ |

> **结论：** 通过提供流动性，LP 的最终价值（$24,500）低于简单持有的价值（$25,000）。这种差额是未实现的**无常损失**（在此特定情景中约为 $500）。

***

#### 💸 费用收入 vs. 无常损失

没有人会做慈善提供流动性，LP 的主要收入来源是交易费用：

* **费用分配：** **0.3%** 的所有交易量按比例分配给所有流动性提供者。
* **收取：** 默认情况下，这些费用会返还到流动性池中，但可以随时提取。

提供流动性的盈利能力取决于累积的费用收入与定向价格变化带来的潜在无常损失之间的权衡。

> **核心要点：** 代币对经历的**来回波动**（即更多交易）越多，对 LP 越有利，因为它能产生更多费用，而不会带来持续的、单向的价格变化从而造成显著的无常损失。

***

#### 📉 无常损失计算

流动性提供者的权益价值相较于简单持有基础资产而下降的现象称为**无常损失（Impermanent Loss, IL）**。这种损失是暂时的，如果价格回归到初始水平，它将消失。

我们可以根据流动性供应时的价格与当前价格的比率（$P\_r$）来量化无常损失：

$$\text{无常损失} = \frac{2 \times \sqrt{P_r}}{1 + P_r} - 1$$

**价格变化与损失对照表**

无论价格向哪个方向移动（即价格翻倍与价格减半带来的损失相同），损失都是对称的。

|  价格变化 ($P\_r$) | 无常损失（相对于 HODL） |
| :------------: | :------------: |
|   **1.25 倍**   |     0.6% 损失    |
|   **1.50 倍**   |     2.0% 损失    |
| **2 倍**（翻倍/减半） |   **5.7% 损失**  |
|     **3 倍**    |    13.4% 损失    |
|     **4 倍**    |    20.0% 损失    |
|     **5 倍**    |    25.5% 损失    |
