# 💧 资金池 (Pools)

### 💧 资金池 (Pools)

#### 📝 介绍

每个 SwapX 流动性池都是一对 ERC20 代币的交易场所。

创建池合约时，其每个代币的余额为零。为了让池开始促进交易，必须有人用每个代币的初始存款为其提供种子。

**初始价格设定**

第一个流动性提供者 (LP) 是设定池初始价格的人。他们有动力将等值的两种代币存入池中。

> 为何需要等值？
>
> 如果第一个 LP 以不同于当前市场利率的比率存入代币，这会立即创造一个有利可图的套利机会，外部方很可能抓住这个机会。

**添加流动性**

当其他流动性提供者向现有池中添加资金时，他们必须存入与当前价格成比例的配对代币。如果他们不这样做，他们添加的流动性也面临被套利的风险。如果他们认为当前价格不正确，他们可能会先将其套利到他们想要的水平，并以该价格添加流动性。

***

#### 🪙 资金池代币 (LP 代币)

每当流动性存入池中时，就会生成独特的代币（称为流动性代币或 LP 代币）并发送到提供者的地址。这些代币代表特定流动性提供者对池的贡献。

* 池提供的流动性比例决定了提供者收到的 LP 代币数量。
* 如果提供者正在生成新池，他们将收到的 LP 代币数量将等于 $$ $\sqrt{x \times y}$ $$，其中 $$ $x$ $$ 和 $$ $y$ $$ 表示每个提供的代币数量。

**费用累积和赎回**

1. 费用收取： 每次发生交易时，交易发送者都会被收取 0.3% 的费用。
2. 费用分配： 交易完成后，该费用将按比例分配给池中的所有 LP。
3. 赎回： 为了检索基础流动性以及任何累积的费用，流动性提供者必须\*\*“销毁”他们的 LP 代币\*\*，有效地将它们兑换成流动性池中的份额，再加上按比例分配的费用。

> LP 代币作为资产： 由于 LP 代币本身是可交易资产，因此流动性提供者可以以他们认为合适的任何方式出售、转让或以其他方式使用其 LP 代币。

***

#### 💡 为何使用资金池？ (AMM 优势)

SwapX 的独特之处在于它不使用订单簿来推导资产价格或匹配代币的买家和卖家。相反，SwapX 使用所谓的流动性池，由自动化做市商 (AMM) 模型驱动。

| **特性** | **传统订单簿**                        | **SwapX 流动性池**                            |
| ------ | -------------------------------- | ----------------------------------------- |
| 流动性表示  | 个人在集中运营系统上下达的离散订单。               | 受智能合约公式 ($$ $x \times y = k$ $$) 管理的汇集资产。 |
| 管理方式   | 需要做市商积极管理、持续更新、复杂的基础设施和算法。       | 被动；一旦提供种子，就由代码自动运行。                       |
| 基础设施   | 需要托管订单簿和匹配订单的中介基础设施，产生控制点并增加复杂性。 | 区块链原生；自主的智能合约执行。                          |
| 可访问性   | 由于基础设施和算法，通常限制在高级交易者范围内。         | 开放、无需许可、包容的访问模型。                          |

**区块链原生的方法**

虽然订单簿是金融的基础，但它们存在一些重要的限制，特别是在应用于去中心化环境时：

* 它们需要中介基础设施，这会产生控制点。
* 它们需要做市商的积极参与和管理，限制了参与度。
* 它们是在交易资产相对较少的世界中发明的，因此不适合任何人都可以创建自己代币的生态系统（这些代币通常流动性较低）。

SwapX 专注于利用以太坊等平台的优势，从第一原理重新构想代币交换。一个区块链原生的流动性协议应该利用：

* 可信的代码执行环境。
* 自主且永久运行的虚拟机。
* 开放、无需许可且包容的访问模型，从而产生呈指数增长的虚拟资产生态系统。

**与资金池交互**

需要重申的是，池只是一个智能合约，由用户调用其上的函数来操作：

* 交换代币是调用池合约实例上的 `swap` 函数。
* 提供流动性是调用 `deposit` 函数。

就像最终用户可以通过接口（进而与底层合约交互）与 SwapX 协议交互一样，开发人员可以直接与智能合约交互，并将 SwapX 功能集成到他们自己的应用程序中，而无需依赖中介或需要许可。
